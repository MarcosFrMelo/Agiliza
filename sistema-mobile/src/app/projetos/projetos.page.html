<ion-header class="ion-no-border">
  <ion-toolbar color="primary" style="--background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <ion-title style="font-weight: 800;">Meus Projetos</ion-title>
    <ion-buttons slot="end">
      <ion-button [routerLink]="['/projeto-cadastro']">
        <ion-icon slot="icon-only" name="add-circle"></ion-icon>
      </ion-button>
      <ion-button (click)="logout()">
        <ion-icon slot="icon-only" name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" style="--background: #f4f5f8;">
  
  <div class="ion-padding" style="min-height: 100%; display: flex; flex-direction: column;">
    
    <div *ngIf="projetos.length > 0">
      <h2 style="font-weight: bold; color: #333; margin-bottom: 5px;">Olá!</h2>
      <p style="color: #666; margin-top: 0; margin-bottom: 20px;">Aqui estão seus quadros de trabalho.</p>
    </div>

    <ion-list style="background: transparent;">
      
      <ion-card *ngFor="let projeto of projetos" class="project-card" style="margin-inline: 0; margin-bottom: 20px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
        
        <div style="height: 140px; background: #e9ecef; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative;">
            <img [src]="projeto.imagem_capa" 
                 style="width: 100%; height: 100%; object-fit: cover;" 
                 *ngIf="projeto.imagem_capa; else placeholder">
            
            <ng-template #placeholder>
              <div style="display: flex; flex-direction: column; align-items: center; color: #cbd5e0;">
                <ion-icon name="image-outline" style="font-size: 40px;"></ion-icon>
                <span style="font-size: 12px; margin-top: 5px;">Sem capa</span>
              </div>
            </ng-template>
            
            <ion-fab vertical="top" horizontal="end" edge slot="fixed" style="top: 15px; right: 15px;">
               <ion-fab-button size="small" color="light" style="--box-shadow: 0 2px 5px rgba(0,0,0,0.3);" (click)="$event.stopPropagation(); presentActionSheet(projeto)">
                 <ion-icon name="ellipsis-vertical" color="dark"></ion-icon>
               </ion-fab-button>
            </ion-fab>
        </div>

        <ion-card-header>
          <ion-card-title style="font-size: 1.3rem; font-weight: 800;">{{ projeto.nome }}</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <p style="color: #666; font-size: 1rem; min-height: 40px; margin-bottom: 15px;">
            {{ projeto.descricao || 'Sem descrição definida.' }}
          </p>
          
          <ion-button expand="block" fill="outline" shape="round" (click)="abrirQuadro(projeto)" style="height: 50px; font-weight: bold;">
            Ver Quadro
            <ion-icon slot="end" name="arrow-forward"></ion-icon>
          </ion-button>
        </ion-card-content>

      </ion-card>

    </ion-list>

    <div *ngIf="projetos.length === 0" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0.6; min-height: 60vh;">
      <ion-icon name="file-tray-outline" style="font-size: 80px; color: #ccc; margin-bottom: 20px;"></ion-icon>
      <h3 style="color: #666; font-weight: bold;">Nenhum projeto ainda</h3>
      <ion-button fill="clear" size="large" [routerLink]="['/projeto-cadastro']">Criar o primeiro</ion-button>
    </div>

  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button color="primary" [routerLink]="['/projeto-cadastro']">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>